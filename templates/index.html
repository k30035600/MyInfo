<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµê±°ë˜ í†µí•©ì •ë³´ (MyInfo)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; margin: 0; padding: 0; }
        body { font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        .container { max-width: 1920px; width: 100%; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); padding: 40px; text-align: center; }
        .header { margin-bottom: 6px; display: flex; flex-wrap: wrap; align-items: flex-start; justify-content: space-between; gap: 16px; }
        .header-left { flex: 1; min-width: 0; }
        .header h1 { font-size: 2.5em; color: #333; margin-bottom: 4px; font-weight: bold; }
        .header p { font-size: 1.2em; color: #666; margin-top: 4px; }
        .header-cache { flex: 0 0 auto; text-align: right; font-size: 0.85em; color: #555; background: #f5f5f5; padding: 10px 14px; border-radius: 8px; border: 1px solid #e0e0e0; }
        .header-cache .cache-title { font-weight: bold; margin-bottom: 6px; color: #333; }
        .header-cache .cache-app { margin-bottom: 4px; }
        .header-cache .cache-total { margin-top: 6px; padding-top: 6px; border-top: 1px solid #ddd; font-weight: bold; }
        .services { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 40px; }
        .service-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 40px; text-decoration: none; color: white; transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 5px 15px rgba(0,0,0,0.2); display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 250px; }
        .service-card:hover { transform: translateY(-10px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .service-card.bank { background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%); }
        .service-card.card { background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%); }
        .service-card.cash { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .service-card h2 { font-size: 2em; margin-bottom: 20px; font-weight: bold; }
        .service-card p { font-size: 1.1em; line-height: 1.6; opacity: 0.95; }
        .service-card .icon { font-size: 4em; margin-bottom: 20px; }
        .features { margin-top: 50px; padding-top: 40px; border-top: 2px solid #eee; transition: background 0.2s; }
        .features:hover { background: #fafafa; border-radius: 10px; }
        .features h3 { font-size: 1.5em; color: #333; margin-bottom: 30px; }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .feature-item { padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #667eea; }
        .feature-item h4 { color: #333; margin-bottom: 10px; font-size: 1.1em; }
        .feature-item p { color: #666; font-size: 0.9em; }
        .feature-item.shutdown-item { cursor: pointer; border-left-color: #999; }
        .feature-item.shutdown-item:hover { background: #e8e8e8; border-left-color: #555; }
        .feature-item.shutdown-item:focus { outline: 2px solid #667eea; outline-offset: 2px; }
        @media (max-width: 768px) { .container { padding: 20px; } .header h1 { font-size: 2em; } .header p { font-size: 1em; } .services { grid-template-columns: 1fr; gap: 20px; } .service-card { padding: 30px; min-height: 200px; } .service-card h2 { font-size: 1.5em; } .service-card .icon { font-size: 3em; } .features-grid { grid-template-columns: 1fr; } }
        @media (max-width: 480px) { .header h1 { font-size: 1.5em; } .service-card { padding: 20px; min-height: 180px; } .service-card h2 { font-size: 1.3em; } .service-card p { font-size: 0.9em; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <h1>ğŸ’° ê¸ˆìœµê±°ë˜ í†µí•©ì •ë³´</h1>
                <p>MyInfo - Financial Information System Ver. {{ version }}{% if server_start_time %} (ê¸°ë™ {{ server_start_time }}){% endif %}</p>
                <p style="font-size: 0.9em; color: #999; margin-top: 5px;">ì€í–‰/ì‹ ìš©ì¹´ë“œ ê±°ë˜ í†µí•©ê´€ë¦¬ ë° ì¢…í•©ë¶„ì„</p>
            </div>
            <div id="header-cache" class="header-cache" aria-label="ìºì‹œ ë©”ëª¨ë¦¬">
                <div class="cache-title">ìºì‹œ ë©”ëª¨ë¦¬</div>
                <div id="cache-info-content">ë¡œë”© ì¤‘...</div>
                <div id="cache-info-total" class="cache-total"></div>
            </div>
        </div>
        <div class="services">
            <a href="/bank/" class="service-card bank"><div class="icon">ğŸ¦</div><h2>ì€í–‰ê±°ë˜ í†µí•©ì •ë³´</h2><p>MyBank</p><p style="margin-top: 15px; font-size: 0.95em;">ì€í–‰ ê±°ë˜ ë‚´ì—­ì„ ì „ì²˜ë¦¬, ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜,<br>ê¸°ë³¸ ë¶„ì„, ë„ì›€ë§ì„ í†µí•´ ê´€ë¦¬í•©ë‹ˆë‹¤.</p></a>
            <a href="/card/" class="service-card card"><div class="icon">ğŸ’³</div><h2>ì‹ ìš©ì¹´ë“œ í†µí•©ì •ë³´</h2><p>MyCard</p><p style="margin-top: 15px; font-size: 0.95em;">ì‹ ìš©ì¹´ë“œ ê±°ë˜ ë‚´ì—­ì„ ì „ì²˜ë¦¬, ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜,<br>ê¸°ë³¸ ë¶„ì„, ê³ ê¸‰ ë¶„ì„ì„ í†µí•´ ê´€ë¦¬í•©ë‹ˆë‹¤.</p></a>
            <a href="/cash/" class="service-card cash"><div class="icon">ğŸ“‹</div><h2>ê¸ˆìœµì •ë³´ ì¢…í•©ë¶„ì„</h2><p>MyCash</p><p style="margin-top: 15px; font-size: 0.95em;">ì€í–‰Â·ì‹ ìš©ì¹´ë“œ ê±°ë˜ë¥¼ í•˜ë‚˜ë¡œ ëª¨ì•„ ì „ì²˜ë¦¬, ì¹´í…Œê³ ë¦¬,<br>ê¸°ë³¸ ë¶„ì„, ê³ ê¸‰ ë¶„ì„ìœ¼ë¡œ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.</p></a>
        </div>
        <div class="features">
            <h3>ì£¼ìš” ê¸°ëŠ¥</h3>
            <div class="features-grid">
                <div class="feature-item"><h4>ğŸ“Š ì „ì²˜ë¦¬</h4><p>ì›ë³¸ ë°ì´í„°ë¥¼ ì •ì œí•˜ê³  í‘œì¤€í™”ëœ í˜•ì‹ìœ¼ë¡œ ë³€í™˜</p></div>
                <div class="feature-item"><h4>ğŸ·ï¸ ì¹´í…Œê³ ë¦¬</h4><p>ê±°ë˜ ë‚´ì—­ì„ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ìë™ ë¶„ë¥˜ ë° ê´€ë¦¬</p></div>
                <div class="feature-item"><h4>ğŸ“ˆ ê¸°ë³¸ë¶„ì„</h4><p>ê±°ë˜ í†µê³„, ì›”ë³„ ì¶”ì´ ë“± ê¸°ë³¸ì ì¸ ë¶„ì„ ì œê³µ</p></div>
                <div id="shutdown-area" class="feature-item shutdown-item" role="button" tabindex="0" title="í´ë¦­ ì‹œ ì„œë²„ ì¢…ë£Œ ë° ìºì‹œ ì´ˆê¸°í™”"><h4>ğŸ”’ ì‘ì—…ì¢…ë£Œ</h4><p>ì„œë²„ ì¢…ë£Œ ë° ìºì‹œ ì´ˆê¸°í™”</p></div>
            </div>
        </div>
    <script>
        (function() {
            var el = document.getElementById('shutdown-area');
            function doShutdown() {
                if (confirm('ì„œë²„ë¥¼ ì¢…ë£Œí•˜ê³  ìºì‹œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\në‹¤ìŒ ì„œë²„ ê¸°ë™ ì‹œ ì²˜ìŒë¶€í„° ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    window.location.href = '/shutdown';
                }
            }
            if (el) {
                el.addEventListener('click', doShutdown);
                el.addEventListener('keydown', function(e) { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); doShutdown(); } });
            }
        })();
        (function() {
            var contentEl = document.getElementById('cache-info-content');
            var totalEl = document.getElementById('cache-info-total');
            if (!contentEl) return;
            var urls = [
                { url: '/bank/api/cache-info', app: 'MyBank' },
                { url: '/card/api/cache-info', app: 'MyCard' },
                { url: '/cash/api/cache-info', app: 'MyCash' }
            ];
            var results = [];
            var totalBytes = 0;
            function human(b) {
                if (b < 1024) return b + ' B';
                if (b < 1024 * 1024) return (b / 1024).toFixed(1) + ' KB';
                return (b / (1024 * 1024)).toFixed(2) + ' MB';
            }
            function render() {
                if (results.length === 0) {
                    contentEl.textContent = 'ìºì‹œ ì—†ìŒ';
                    if (totalEl) totalEl.textContent = '';
                    return;
                }
                var html = '';
                results.forEach(function(r) {
                    if (r.error) {
                        html += '<div class="cache-app">' + r.app + ': ì˜¤ë¥˜</div>';
                        return;
                    }
                    html += '<div class="cache-app"><strong>' + r.app + '</strong>';
                    if (r.caches && r.caches.length) {
                        r.caches.forEach(function(c) {
                            html += ' Â· ' + c.name + ' ' + c.size_human;
                        });
                    } else {
                        html += ' (ë¹„ì–´ ìˆìŒ)';
                    }
                    html += '</div>';
                });
                contentEl.innerHTML = html;
                if (totalEl && totalBytes >= 0) {
                    totalEl.textContent = 'ì´ ë©”ëª¨ë¦¬: ' + human(totalBytes);
                }
            }
            var pending = urls.length;
            urls.forEach(function(item) {
                fetch(item.url).then(function(res) { return res.json(); }).then(function(data) {
                    results.push(data);
                    if (data.total_bytes) totalBytes += data.total_bytes;
                    pending--;
                    if (pending === 0) render();
                }).catch(function() {
                    results.push({ app: item.app, error: true });
                    pending--;
                    if (pending === 0) render();
                });
            });
        })();
    </script>
    </div>
</body>
</html>
