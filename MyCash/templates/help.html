<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>금융정보 도움말 - MyInfo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Malgun Gothic', '맑은 고딕', sans-serif; background-color: #f5f5f5; padding: 20px; }
        .container { max-width: 1920px; margin: 0 auto; background: white; border-radius: 10px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #333; margin-bottom: 30px; font-size: 2em; }
        h2 { color: #667eea; margin-top: 30px; margin-bottom: 15px; font-size: 1.5em; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
        h3 { color: #555; margin-top: 20px; margin-bottom: 10px; font-size: 1.2em; }
        h4 { color: #444; margin-top: 14px; margin-bottom: 8px; font-size: 1.05em; }
        .help-section { margin-bottom: 30px; }
        .help-section p { line-height: 1.8; color: #666; margin-bottom: 10px; }
        .help-section ul, .help-section ol { margin-left: 20px; margin-bottom: 15px; }
        .help-section li { line-height: 1.8; color: #666; margin-bottom: 5px; }
        .code-block { background: #f8f9fa; border-left: 4px solid #667eea; padding: 15px; margin: 15px 0; border-radius: 4px; font-family: 'Courier New', monospace; overflow-x: auto; }
        .main-nav { display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .nav-item { padding: 10px 15px; background: rgba(255,255,255,0.9); color: #333; text-decoration: none; border-radius: 5px; font-weight: bold; font-size: 14px; transition: all 0.3s ease; flex: 1; min-width: 120px; text-align: center; white-space: nowrap; }
        .nav-item:hover { background: rgba(255,255,255,1); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .nav-item.active { background: #FF9800; color: white; }
        .toc { background: #f0f4ff; padding: 20px; border-radius: 8px; margin-bottom: 25px; }
        .toc ul { list-style: none; margin-left: 0; }
        .toc a { color: #667eea; text-decoration: none; }
        .toc a:hover { text-decoration: underline; }
        table.risk-table { border-collapse: collapse; width: 100%; margin: 15px 0; font-size: 14px; }
        table.risk-table th, table.risk-table td { border: 1px solid #ddd; padding: 8px 12px; text-align: left; }
        table.risk-table th { background: #f0f4ff; color: #333; }
        @media (max-width: 768px) { .container { padding: 20px; } .nav-item { font-size: 11px; padding: 6px 8px; min-width: 80px; } }
    </style>
</head>
<body>
    <nav class="main-nav" aria-label="금융정보 메뉴">
        <a href="/" class="nav-item">🏠 홈</a>
        <a href="/cash/" class="nav-item">🏦 금융정보 전처리</a>
        <a href="/cash/category" class="nav-item">🏷️ 금융정보 카테고리</a>
        <a href="/cash/analysis/basic" class="nav-item">📊 금융정보 기본분석</a>
        <a href="/cash/help" class="nav-item active">❓ 금융정보 도움말</a>
    </nav>
    <div class="container">
        <h1>❓ 금융정보 도움말</h1>
        <p>금융정보(MyCash)는 <strong>은행거래(bank_after)</strong>와 <strong>신용카드(card_after)</strong>를 하나로 합쳐 통합 관리·위험도 분류·종합 분석을 제공합니다.</p>

        <div class="help-section toc">
            <h2>목차</h2>
            <ul>
                <li><a href="#flow">1. 사용 흐름</a></li>
                <li><a href="#pages">2. 메뉴별 안내</a></li>
                <li><a href="#cash-after">3. cash_after 생성(병합)</a></li>
                <li><a href="#risk">4. 위험도분류(1~8호)</a></li>
                <li><a href="#trouble">5. 문제 해결</a></li>
                <li><a href="#faq">6. 자주 묻는 질문</a></li>
            </ul>
        </div>

        <div class="help-section" id="flow">
            <h2>1. 사용 흐름</h2>
            <ol>
                <li><strong>은행·카드 전처리</strong>: .source/Bank, .source/Card에 원본 엑셀을 넣고 각각 전처리하여 bank_after, card_after를 만듭니다.</li>
                <li><strong>금융정보 전처리(/cash/)</strong>: 화면에서 은행·카드 데이터를 확인한 뒤 <strong>「cash_after 생성(병합)」</strong>을 클릭합니다. bank_after + card_after가 합쳐져 <strong>MyCash/cash_after.json</strong>이 생성되고, 1~8호 위험도가 자동 적용됩니다.</li>
                <li><strong>금융정보 카테고리(/cash/category)</strong>: 「금융정보(위험도분류) 적용후」 테이블에서 위험도키워드·위험도분류·위험도·필터·출력을 확인합니다.</li>
                <li><strong>금융정보 기본분석(/cash/analysis/basic)</strong>: cash_after 기준 통계·차트를 확인합니다.</li>
            </ol>
            <p><strong>참고</strong>: 금융정보 메뉴에 들어갈 때마다 기존 <strong>cash_after.json</strong>이 삭제됩니다. 데이터를 보려면 전처리 후 다시 「cash_after 생성(병합)」을 실행하세요.</p>
        </div>

        <div class="help-section" id="pages">
            <h2>2. 메뉴별 안내</h2>
            <h3>금융정보 전처리 (/cash/)</h3>
            <p>은행거래(bank_after)와 신용카드(card_after) 테이블을 한 화면에서 볼 수 있습니다. <strong>cash_after 생성(병합)</strong> 버튼을 누르면 두 데이터를 합쳐 cash_after.json을 만들고, linkage_table 매칭과 1~8호 위험도 지표를 적용한 뒤 저장합니다.</p>
            <h3>금융정보 카테고리 (/cash/category)</h3>
            <p>카테고리 정의 테이블과 <strong>금융정보(위험도분류) 적용후</strong> 테이블을 제공합니다. 적용후 테이블은 cash_after.json을 위험도·위험도키워드·거래일·거래시간 내림차순으로 정렬하며, 헤더는 스크롤 시 고정됩니다. 각 컬럼의 드롭다운으로 필터링하고 「📄 출력」으로 인쇄용 창을 띄울 수 있습니다.</p>
            <h3>금융정보 기본분석 (/cash/analysis/basic)</h3>
            <p>cash_after 기준 전체 통계, 카테고리별·월별·금융사별 집계와 차트를 제공합니다.</p>
        </div>

        <div class="help-section" id="cash-after">
            <h2>3. cash_after 생성(병합)</h2>
            <p>bank_after와 card_after를 병합할 때 다음이 수행됩니다.</p>
            <ul>
                <li>금융사·계좌번호·거래일·거래시간·입금액·출금액·기타거래·키워드·카테고리·사업자번호·구분 등 컬럼 통합</li>
                <li>linkage_table.json으로 위험도키워드→위험도분류·위험도 매칭</li>
                <li>risk_indicators 적용: 1~8호 순서로 위험도키워드·위험도분류·위험도 저장(기본 위험도 0.1)</li>
                <li>고위험(가상자산·증권투자·금전대부) 카테고리 보정 시 위험도 5.0 설정</li>
            </ul>
            <p>결과 파일: <strong>MyCash/cash_after.json</strong></p>
        </div>

        <div class="help-section" id="risk">
            <h2>4. 위험도분류(1~8호) 상세</h2>
            <p>금융정보(cash_after) 생성(병합) 시 <strong>1호부터 8호</strong>까지 순서대로 위험도 지표가 적용됩니다. 모든 행의 기본 위험도는 <strong>0.1</strong>이며, 조건에 맞는 행에만 위험도키워드·위험도분류·위험도가 설정됩니다. <strong>나중 호수가 이전 호수를 덮어씁니다.</strong> 적용 전 데이터는 카테고리·키워드·거래일 올림차순으로 정렬된 뒤 진행됩니다.</p>

            <h3>4.1 검색 텍스트 (2~8호 공통)</h3>
            <p>2호부터 8호까지 매칭 시 사용하는 검색 텍스트는 <strong>(카테고리 + 키워드) + 기타거래</strong>를 붙인 문자열입니다. 공백 기준으로 동일한 단어(토큰)는 한 번만 남기고 제거한 뒤 키워드 포함 여부를 판단합니다. 1호·2호는 금액·횟수 조건과 해당 행의 키워드(또는 기타거래) 값을 위험도키워드에 저장하는 방식입니다.</p>

            <h3>4.2 호별 상세 조건 및 키워드</h3>
            <table class="risk-table">
                <thead>
                    <tr><th>호수</th><th>위험도분류</th><th>위험도</th><th>금액/횟수 조건</th><th>키워드·기타 조건</th></tr>
                </thead>
                <tbody>
                    <tr><td>1호</td><td>자료소명지표</td><td>1.0</td><td>출금액 <strong>1000만원 이상</strong></td><td>해당 행의 <strong>키워드</strong>(또는 기타거래) 값을 위험도키워드에 그대로 저장. 키워드 매칭 없음.</td></tr>
                    <tr><td>2호</td><td>비정형지표</td><td>1.5</td><td><strong>출금만</strong> 100만원 이상인 거래가 <strong>같은 키워드(특정인) 기준 5회 이상</strong></td><td>해당 키워드(특정인)를 위험도키워드에 저장. 입금액 0이고 출금만 100만원 이상인 행만 집계 후, 키워드별 건수 5회 이상인 키워드의 해당 행들에 2호 부여.</td></tr>
                    <tr><td>3호</td><td>투기성지표</td><td>2.0</td><td>입금 또는 출금 <strong>50만원 이상</strong></td><td>검색 텍스트에 <strong>증권, 선물, 자산운용, 위탁, 증권입금</strong> 중 하나 포함. 단, <strong>하나증권금융센터</strong>가 포함된 행은 3호에서 제외(카드사 금융센터 명칭).</td></tr>
                    <tr><td>4호</td><td>사기파산지표</td><td>2.5</td><td>입금 또는 출금 50만원 이상</td><td>검색 텍스트에 <strong>대부, P2P, 카드깡, 원리금</strong> 중 하나 포함.</td></tr>
                    <tr><td>5호</td><td>가상자산지표</td><td>3.0</td><td>입금 또는 출금 50만원 이상</td><td>(1) 해당 행의 <strong>카테고리</strong>가 "가상자산" 이거나, (2) 검색 텍스트에 <strong>업비트, 빗썸, 코인원, 코빗, 가상자산, VASP, 거래소, 코인, 비트코인, 암호화폐</strong> 중 하나 포함.</td></tr>
                    <tr><td>6호</td><td>자산은닉지표</td><td>3.5</td><td><strong>출금만</strong> 50만원 이상 (입금 0)</td><td>검색 텍스트에 <strong>해외송금, 고액현금인출, 외화송금, 영문성명, Wise, TransferWise, SWIFT</strong> 중 하나 포함.</td></tr>
                    <tr><td>7호</td><td>과소비지표</td><td>4.0</td><td>출금만 30만원 이상 (입금 0)</td><td>검색 텍스트에 <strong>백화점, 명품, 귀금속, 유흥, 고가가전, 고가가구, 유흥주점, 무도장, 콜라텍, 댄스홀</strong> 중 하나 포함.</td></tr>
                    <tr><td>8호</td><td>사행성지표</td><td>5.0</td><td>출금만 10만원 이상 (입금 0)</td><td>검색 텍스트에 <strong>경마, 복권, 사설도박, 도박기계, 사행성게임기, 오락기구, 휴게텔, 키스방, 대화방, 안마, 마사지, 사행성, 도박</strong> 중 하나 포함.</td></tr>
                </tbody>
            </table>

            <h3>4.3 위험도키워드 저장 방식</h3>
            <ul>
                <li><strong>1호·2호</strong>: 해당 행의 <strong>키워드</strong>(또는 기타거래) 값을 그대로 위험도키워드에 저장합니다. (특정인·자료 소명 대상 식별용)</li>
                <li><strong>3~8호</strong>: 검색 텍스트에서 <strong>처음 매칭된 키워드</strong> 하나를 위험도키워드에 저장합니다. (예: 증권, 대부, 업비트, 해외송금 등)</li>
            </ul>

            <h3>4.4 고위험 카테고리 보정</h3>
            <p>cash_after 생성 시 <strong>가상자산·증권투자·금전대부</strong> 등 고위험 카테고리에 해당하는 행은 별도 보정 로직으로 <strong>위험도 5.0</strong>이 설정될 수 있습니다. (linkage_table 또는 내부 규칙 적용)</p>

            <h3>4.5 참고 파일</h3>
            <p>구현: <code>MyCash/risk_indicators.py</code> — <code>apply_risk_indicators()</code>. 문서: readme(삭제하지 말것) 폴더의 <strong>금융정보_위험도_지표_매칭_가이드.md</strong>, <strong>금융정보_위험도_분류_저장.md</strong>, <strong># 모든 행의 위험도는 0.1이 기본.txt</strong>를 참고하세요.</p>
        </div>

        <div class="help-section" id="trouble">
            <h2>5. 문제 해결</h2>
            <h3>데이터가 없습니다</h3>
            <p>금융정보 카테고리에서 이 메시지가 나오면 cash_after.json이 없거나 비어 있는 상태입니다. 금융정보 전처리에서 <strong>cash_after 생성(병합)</strong>을 실행하세요. 은행·카드 전처리를 먼저 완료해 bank_after, card_after가 있어야 합니다.</p>
            <h3>위험도가 모두 0.1로 나와요</h3>
            <p>1~8호 조건에 맞는 거래가 없거나, 예전에 생성된 cash_after를 쓰는 경우입니다. <strong>cash_after 생성(병합)</strong>을 다시 실행하면 최신 위험도 규칙이 적용됩니다.</p>
            <h3>한글 깨짐 / Add-Content 오류</h3>
            <p>경로에 한글이 있거나 TEMP 폴더가 한글 경로일 때 발생할 수 있습니다. readme(삭제하지 말것)의 <strong>한글_깨짐_Add-Content_오류.md</strong>, <strong>start-cursor-no-hangul.ps1</strong>을 참고해 한글이 없는 경로(C:\CursorWorkspace 등)에서 작업하세요.</p>
        </div>

        <div class="help-section" id="faq">
            <h2>6. 자주 묻는 질문</h2>
            <p><strong>Q. 금융정보에 들어가면 cash_after가 사라져요.</strong><br>의도된 동작입니다. 금융정보 메뉴 진입 시 cash_after.json을 삭제하므로, 매번 「cash_after 생성(병합)」으로 최신 병합·위험도 결과를 만듭니다.</p>
            <p><strong>Q. 위험도키워드에 지표명(비정형지표 등)이 들어가요.</strong><br>1·2호는 해당 행의 키워드(또는 기타거래) 값을, 3~8호는 매칭된 키워드(증권, 대부 등)를 저장합니다. cash_after를 다시 생성하면 반영됩니다.</p>
            <p><strong>Q. 통합 도움말은 어디서 보나요?</strong><br>홈에서 <strong>금융정보 보고서</strong> 또는 <a href="/help">/help</a>로 접속하면 은행·카드·금융정보 전체 도움말을 볼 수 있습니다.</p>
        </div>
    </div>
</body>
</html>
